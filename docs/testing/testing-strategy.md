# Стратегія тестування

## Поточний статус тестування

### Прогрес

Рівень зрілості тестування – визначений.

**Backend:**
- **Unit тести**: Реалізовані для основних handler'ів (auth, user, document)
- **Functional тести**: Налаштовані для API endpoints з повним стеком (PostgreSQL + Docker)
- **CI/CD інтеграція**: Автоматичне виконання тестів при кожному push
- **Linters**: golangci-lint для статичного аналізу коду

**Frontend:**
- **Linters**: ESLint з TypeScript підтримкою

### Покриття тестами

**Backend:**
- Handler layer: auth (login, refresh), registration, user operations, document operations
- Тестові сценарії: успішні операції, валідація, обробка помилок, edge cases

**Frontend:**
- Покриття: 0% (потрібно додати тести)

## Швидке планування тестів

| № | Компонент/функція | Рівень тесту | Тип (позитивний/негативний) | Очікуваний результат / критерій прийняття | Власник тесту |
|---|-------------------|--------------|----------------------------|-------------------------------------------|---------------|
| 1 | **Аутентифікація (Login)** | Unit | Позитивний | Успішний логін з валідними credentials, повертає JWT токен | Artur |
| 1.1 | **Аутентифікація (Login)** | Integration | Негативний | Відхилення логіну з невалідними credentials, повертає 401 | Artur |
| 2 | **Створення документа** | Unit | Позитивний | Створення документа з валідними даними, збереження в БД | Vladyslav |
| 2.1 | **Створення документа** | Integration | Негативний | Відхилення створення без авторизації, повертає 401 | Vladyslav |
| 3 | **Управління групами** | Unit | Позитивний | Створення групи з валідними параметрами, призначення ролей | Oleksii |
| 3.1 | **Управління групами** | Integration | Негативний | Відхилення створення групи без прав доступу, повертає 403 | Oleksii |
| 4 | **Спільне редагування (WebSocket)** | Integration | Позитивний | Створення WebSocket з'єднання, надсилання повідомлень, синхронізація змін між користувачами | Vladyslav |
| 4.1 | **Спільне редагування (WebSocket)** | Integration | Позитивний | Вирішення конфліктів при одночасному редагуванні, автоматичне злиття змін | Vladyslav |
| 4.2 | **Спільне редагування (WebSocket)** | Integration | Негативний | Відключення WebSocket при втраті з'єднання, відновлення стану документа | Vladyslav |
| 5 | **Продуктивність API** | Performance | Позитивний | Час відповіді API < 2 секунди для 95% запитів | Yaroslav |
| 6 | **Безпека JWT токенів** | Security | Негативний | Відхилення запитів з простроченими або невалідними токенами | Yaroslav |

## Плани для інтеграційних, системних та приймальних тестів

### 1. Інтеграційні тести

**Backend API тести:**
- **FR-001 Пошук документів**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з пошуком серед документів користувача
- **FR-002 Версіонування документів**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з створенням, переглядом та відновленням версій
- **FR-003 Гостовий доступ**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з доступом без реєстрації
- **FR-004 Спільне редагування**: Тестування WebSocket-ів та real-time колаборації
- **FR-005 Управління групами**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з створенням та управлінням групами
- **FR-006 Система ролей**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з різними ролями
- **FR-007 Поширення документів**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з створенням та управлінням посиланнями
- **FR-008 Експорт документів**: Тестування відповідних хендлерів, сервісів та репозиторіїв, пов'язаних з експортом у різних форматах

### 2. Системні тести

**End-to-End тести:**
- **US-001 Пошук серед документів**: Авторизований користувач → вводить текст в поле пошуку → бачить відповідні документи
- **US-002 Історія версій**: Користувач в режимі редагування → натискає "Історія версій" → бачить версії → відновлює обрану версію
- **US-003 Гостовий доступ**: Гість → переходить за посиланням → отримує відповідні права доступу (Без авторизації → отримує доступ до документа → має обмежені права)
- **US-004 Редагування документу**: Два користувачі → редагують одночасно → бачать зміни у реальному часі → зберігають зміни
- **US-005 Групи та керування ними**: Авторизований користувач → створює/керує групами → навігує між групами та документами
- **US-006 Ролі у групі**: Користувач у групі → тестує ролі (Автор/Співавтор/Оглядач) → перевіряє права доступу
- **US-007 Поширення документів**: Автор/Співавтор → натискає "Поширити документ" → налаштовує доступ → генерує посилання
- **US-008 Експорт документу**: Користувач з доступом → натискає "Експорт документу" → вибирає формат → завантажує

### 3. Приймальні тести

Системні тести вже покривають user stories, над чимось іншим думати ще ранувато, це буде просто пальцем в небо.

## Плани для тестування продуктивності, безпеки та property-based тестування

### 1. Тестування продуктивності

- **NFR-001 Час відповіді**: Тестування швидкості синхронізації, 95% часу завантаження < 2 секунди, 99% < 4 секунди

### 2. Тестування безпеки

- **Захист доступу**: Тестування блокування несанкціонованого доступу до документів
- **Аутентифікація**: JWT security, session management для різних ролей
- **Авторизація**: RBAC для ролей (Автор, Співавтор, Оглядач)
- **Input validation**: SQL injection, XSS prevention для Markdown контенту
- **Data protection**: Encryption, GDPR compliance для збереження документів

### 3. Property-based тестування

- **API contracts**: Валідність request/response схем для всіх FR
- **Database constraints**: Data integrity properties для PostgreSQL
- **Business logic**: Invariants для ролей та прав доступу
- **Markdown serialization**: JSON marshaling/unmarshaling для документів
- **WebSocket messages**: Валідність real-time повідомлень

## Інтеграція тестів у CI/CD pipeline

### GitHub Actions Workflow:

```yaml
# .github/workflows/ci.yml
jobs:
  lint:          # Статичний аналіз коду
  unit-tests:    # Unit тести backend
  functional-tests: # Functional тести з Docker
  build-images:  # Збірка Docker образів
  build-go-binary: # Збірка Go binary
```